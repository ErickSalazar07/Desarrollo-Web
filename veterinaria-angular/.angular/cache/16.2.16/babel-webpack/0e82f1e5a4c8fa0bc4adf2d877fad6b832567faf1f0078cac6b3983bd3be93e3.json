{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/servicio/tratamiento.service\";\nimport * as i2 from \"src/app/servicio/mascota.service\";\nimport * as i3 from \"src/app/servicio/droga.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction AsignarTratamientoComponent_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const m_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", m_r4.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r4.nombre);\n  }\n}\nfunction AsignarTratamientoComponent_option_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const d_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", d_r5.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(d_r5.nombre);\n  }\n}\nfunction AsignarTratamientoComponent_option_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const v_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", v_r6.cedula);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(v_r6.nombre);\n  }\n}\nfunction AsignarTratamientoComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.errorMensaje, \" \");\n  }\n}\nexport class AsignarTratamientoComponent {\n  constructor(tratamientoService, mascotaService, drogaService, location) {\n    this.tratamientoService = tratamientoService;\n    this.mascotaService = mascotaService;\n    this.drogaService = drogaService;\n    this.location = location;\n    this.tratamientoDTO = {\n      id: -1,\n      nombreTratamiento: '',\n      fecha: '',\n      drogaAsignadaID: 0,\n      mascotaID: 0,\n      veterinaroCedula: ''\n    };\n    this.mascotas = [];\n    this.drogas = [];\n    this.veterinarios = [];\n    this.errorMensaje = '';\n  }\n  ngOnInit() {\n    this.mascotaService.findAll().subscribe(mascotas => this.mascotas = mascotas);\n    this.drogaService.findAll().subscribe(drogas => this.drogas = drogas);\n  }\n  onSubmit() {\n    this.errorMensaje = '';\n    this.tratamientoDTO.mascotaID = Number(this.tratamientoDTO.mascotaID);\n    this.tratamientoDTO.drogaAsignadaID = Number(this.tratamientoDTO.drogaAsignadaID);\n    const mascotaExiste = this.mascotas.find(m => m.id === this.tratamientoDTO.mascotaID);\n    const drogaExiste = this.drogas.find(d => d.id === this.tratamientoDTO.drogaAsignadaID);\n    const veterinarioExiste = this.veterinarios.find(v => v.cedula === this.tratamientoDTO.veterinaroCedula);\n    console.log(this.tratamientoDTO);\n    if (!mascotaExiste || !drogaExiste || !veterinarioExiste) {\n      let errores = [];\n      if (!mascotaExiste) errores.push('la mascota');\n      if (!drogaExiste) errores.push('la droga');\n      if (!veterinarioExiste) errores.push('el veterinario');\n      this.errorMensaje = `Error: No se encontró ${errores.join(', ')} seleccionado(a).`;\n      return;\n    }\n    if (drogaExiste.unidadDisponible <= 0) {\n      this.errorMensaje = `Error: No hay unidades disponibles de ${drogaExiste.nombre}`;\n      return;\n    }\n    drogaExiste.unidadDisponible--;\n    drogaExiste.unidadVendida++;\n    this.drogaService.updateDroga(drogaExiste).subscribe();\n    this.tratamientoService.addTratamiento(this.tratamientoDTO).subscribe(response => {\n      console.log(response);\n      this.location.back();\n    }, error => {\n      this.errorMensaje = 'Ocurrió un error al asignar el tratamiento.';\n      console.error(error);\n    });\n  }\n  static {\n    this.ɵfac = function AsignarTratamientoComponent_Factory(t) {\n      return new (t || AsignarTratamientoComponent)(i0.ɵɵdirectiveInject(i1.TratamientoService), i0.ɵɵdirectiveInject(i2.MascotaService), i0.ɵɵdirectiveInject(i3.DrogaService), i0.ɵɵdirectiveInject(i4.Location));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AsignarTratamientoComponent,\n      selectors: [[\"app-asignar-tratamiento\"]],\n      decls: 30,\n      vars: 11,\n      consts: [[1, \"formulario\"], [\"for\", \"nombreTratamiento\"], [\"type\", \"text\", \"id\", \"nombreTratamiento\", \"name\", \"nombreTratamiento\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"fecha\"], [\"type\", \"date\", \"id\", \"fecha\", \"name\", \"fecha\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"mascota\"], [\"id\", \"mascota\", \"name\", \"mascota\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"disabled\", \"\", \"selected\", \"\", 3, \"value\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"droga\"], [\"id\", \"droga\", \"name\", \"droga\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"veterinario\"], [\"id\", \"veterinario\", \"name\", \"veterinario\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [\"class\", \"error-mensaje\", 4, \"ngIf\"], [3, \"click\"], [3, \"value\"], [1, \"error-mensaje\"]],\n      template: function AsignarTratamientoComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Asignar Tratamiento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"label\", 1);\n          i0.ɵɵtext(4, \"Nombre del Tratamiento:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"input\", 2);\n          i0.ɵɵlistener(\"ngModelChange\", function AsignarTratamientoComponent_Template_input_ngModelChange_5_listener($event) {\n            return ctx.tratamientoDTO.nombreTratamiento = $event;\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"label\", 3);\n          i0.ɵɵtext(7, \"Fecha:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(8, \"input\", 4);\n          i0.ɵɵlistener(\"ngModelChange\", function AsignarTratamientoComponent_Template_input_ngModelChange_8_listener($event) {\n            return ctx.tratamientoDTO.fecha = $event;\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"label\", 5);\n          i0.ɵɵtext(10, \"Mascota:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"select\", 6);\n          i0.ɵɵlistener(\"ngModelChange\", function AsignarTratamientoComponent_Template_select_ngModelChange_11_listener($event) {\n            return ctx.tratamientoDTO.mascotaID = $event;\n          });\n          i0.ɵɵelementStart(12, \"option\", 7);\n          i0.ɵɵtext(13, \"Seleccione una mascota\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(14, AsignarTratamientoComponent_option_14_Template, 2, 2, \"option\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"label\", 9);\n          i0.ɵɵtext(16, \"Droga:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"select\", 10);\n          i0.ɵɵlistener(\"ngModelChange\", function AsignarTratamientoComponent_Template_select_ngModelChange_17_listener($event) {\n            return ctx.tratamientoDTO.drogaAsignadaID = $event;\n          });\n          i0.ɵɵelementStart(18, \"option\", 7);\n          i0.ɵɵtext(19, \"Seleccione una droga\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(20, AsignarTratamientoComponent_option_20_Template, 2, 2, \"option\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"label\", 11);\n          i0.ɵɵtext(22, \"Veterinario:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"select\", 12);\n          i0.ɵɵlistener(\"ngModelChange\", function AsignarTratamientoComponent_Template_select_ngModelChange_23_listener($event) {\n            return ctx.tratamientoDTO.veterinaroCedula = $event;\n          });\n          i0.ɵɵelementStart(24, \"option\", 13);\n          i0.ɵɵtext(25, \"Seleccione un veterinario\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(26, AsignarTratamientoComponent_option_26_Template, 2, 2, \"option\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(27, AsignarTratamientoComponent_div_27_Template, 2, 1, \"div\", 14);\n          i0.ɵɵelementStart(28, \"button\", 15);\n          i0.ɵɵlistener(\"click\", function AsignarTratamientoComponent_Template_button_click_28_listener() {\n            return ctx.onSubmit();\n          });\n          i0.ɵɵtext(29, \"Asignar Tratamiento\");\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngModel\", ctx.tratamientoDTO.nombreTratamiento);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.tratamientoDTO.fecha);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.tratamientoDTO.mascotaID);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"value\", 0);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.mascotas);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.tratamientoDTO.drogaAsignadaID);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"value\", 0);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.drogas);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.tratamientoDTO.veterinaroCedula);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngForOf\", ctx.veterinarios);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.errorMensaje);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.DefaultValueAccessor, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.RequiredValidator, i5.NgModel],\n      styles: [\"\\n\\n.formulario[_ngcontent-%COMP%] {\\n    max-width: 600px;\\n    margin: 0 auto;\\n    padding: 30px;\\n    background-color: #f8f9fa;\\n    border-radius: 10px;\\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n    text-align: center;\\n    color: #054f31;\\n    margin-bottom: 30px;\\n    font-size: 24px;\\n    font-weight: 600;\\n    padding-bottom: 10px;\\n    border-bottom: 2px solid #e9ecef;\\n}\\n\\n\\n\\nlabel[_ngcontent-%COMP%] {\\n    display: block;\\n    margin-bottom: 8px;\\n    font-weight: 500;\\n    color: #495057;\\n    font-size: 14px;\\n}\\n\\n\\n\\ninput[_ngcontent-%COMP%], select[_ngcontent-%COMP%] {\\n    width: 100%;\\n    padding: 12px 15px;\\n    margin-bottom: 20px;\\n    border: 1px solid #ced4da;\\n    border-radius: 6px;\\n    font-size: 14px;\\n    transition: all 0.3s ease;\\n    box-sizing: border-box;\\n    background-color: #fff;\\n}\\n\\ninput[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus {\\n    border-color: #054f31;\\n    box-shadow: 0 0 0 3px rgba(5, 79, 49, 0.1);\\n    outline: none;\\n}\\n\\ninput[type=\\\"date\\\"][_ngcontent-%COMP%] {\\n    appearance: none;\\n    background-position: right 10px center;\\n    background-repeat: no-repeat;\\n}\\n\\n\\n\\n.error-mensaje[_ngcontent-%COMP%] {\\n    color: #dc3545;\\n    background-color: #f8d7da;\\n    border: 1px solid #f5c6cb;\\n    padding: 12px;\\n    border-radius: 6px;\\n    margin-bottom: 20px;\\n    font-size: 14px;\\n    text-align: center;\\n}\\n\\n\\n\\nbutton[_ngcontent-%COMP%] {\\n    background-color: #054f31;\\n    color: white;\\n    padding: 14px;\\n    border: none;\\n    border-radius: 6px;\\n    font-size: 16px;\\n    cursor: pointer;\\n    font-weight: 600;\\n    transition: all 0.3s ease;\\n    width: 100%;\\n    margin: 20px 0 10px;\\n    display: block;\\n    text-transform: uppercase;\\n    letter-spacing: 0.5px;\\n}\\n\\nbutton[_ngcontent-%COMP%]:hover {\\n    background-color: #043a26;\\n    transform: translateY(-2px);\\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\\n}\\n\\nbutton[_ngcontent-%COMP%]:active {\\n    transform: translateY(0);\\n}\\n\\n\\n\\n@media (max-width: 768px) {\\n    .formulario[_ngcontent-%COMP%] {\\n        padding: 20px;\\n        margin: 20px;\\n    }\\n    \\n    h2[_ngcontent-%COMP%] {\\n        font-size: 20px;\\n    }\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvdHJhdGFtaWVudG8vYXNpZ25hci10cmF0YW1pZW50by9hc2lnbmFyLXRyYXRhbWllbnRvLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsc0JBQXNCO0FBQ3RCO0lBQ0ksZ0JBQWdCO0lBQ2hCLGNBQWM7SUFDZCxhQUFhO0lBQ2IseUJBQXlCO0lBQ3pCLG1CQUFtQjtJQUNuQix5Q0FBeUM7SUFDekMsNERBQTREO0FBQ2hFOztBQUVBO0lBQ0ksa0JBQWtCO0lBQ2xCLGNBQWM7SUFDZCxtQkFBbUI7SUFDbkIsZUFBZTtJQUNmLGdCQUFnQjtJQUNoQixvQkFBb0I7SUFDcEIsZ0NBQWdDO0FBQ3BDOztBQUVBLCtCQUErQjtBQUMvQjtJQUNJLGNBQWM7SUFDZCxrQkFBa0I7SUFDbEIsZ0JBQWdCO0lBQ2hCLGNBQWM7SUFDZCxlQUFlO0FBQ25COztBQUVBLHNDQUFzQztBQUN0QztJQUNJLFdBQVc7SUFDWCxrQkFBa0I7SUFDbEIsbUJBQW1CO0lBQ25CLHlCQUF5QjtJQUN6QixrQkFBa0I7SUFDbEIsZUFBZTtJQUNmLHlCQUF5QjtJQUN6QixzQkFBc0I7SUFDdEIsc0JBQXNCO0FBQzFCOztBQUVBO0lBQ0kscUJBQXFCO0lBQ3JCLDBDQUEwQztJQUMxQyxhQUFhO0FBQ2pCOztBQUVBO0lBQ0ksZ0JBQWdCO0lBQ2hCLHNDQUFzQztJQUN0Qyw0QkFBNEI7QUFDaEM7O0FBRUEscUNBQXFDO0FBQ3JDO0lBQ0ksY0FBYztJQUNkLHlCQUF5QjtJQUN6Qix5QkFBeUI7SUFDekIsYUFBYTtJQUNiLGtCQUFrQjtJQUNsQixtQkFBbUI7SUFDbkIsZUFBZTtJQUNmLGtCQUFrQjtBQUN0Qjs7QUFFQSwwQkFBMEI7QUFDMUI7SUFDSSx5QkFBeUI7SUFDekIsWUFBWTtJQUNaLGFBQWE7SUFDYixZQUFZO0lBQ1osa0JBQWtCO0lBQ2xCLGVBQWU7SUFDZixlQUFlO0lBQ2YsZ0JBQWdCO0lBQ2hCLHlCQUF5QjtJQUN6QixXQUFXO0lBQ1gsbUJBQW1CO0lBQ25CLGNBQWM7SUFDZCx5QkFBeUI7SUFDekIscUJBQXFCO0FBQ3pCOztBQUVBO0lBQ0kseUJBQXlCO0lBQ3pCLDJCQUEyQjtJQUMzQix3Q0FBd0M7QUFDNUM7O0FBRUE7SUFDSSx3QkFBd0I7QUFDNUI7O0FBRUEsd0JBQXdCO0FBQ3hCO0lBQ0k7UUFDSSxhQUFhO1FBQ2IsWUFBWTtJQUNoQjs7SUFFQTtRQUNJLGVBQWU7SUFDbkI7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbIi8qIEVzdGlsb3MgZ2VuZXJhbGVzICovXG4uZm9ybXVsYXJpbyB7XG4gICAgbWF4LXdpZHRoOiA2MDBweDtcbiAgICBtYXJnaW46IDAgYXV0bztcbiAgICBwYWRkaW5nOiAzMHB4O1xuICAgIGJhY2tncm91bmQtY29sb3I6ICNmOGY5ZmE7XG4gICAgYm9yZGVyLXJhZGl1czogMTBweDtcbiAgICBib3gtc2hhZG93OiAwIDRweCAxMnB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgVGFob21hLCBHZW5ldmEsIFZlcmRhbmEsIHNhbnMtc2VyaWY7XG59XG5cbmgyIHtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgY29sb3I6ICMwNTRmMzE7XG4gICAgbWFyZ2luLWJvdHRvbTogMzBweDtcbiAgICBmb250LXNpemU6IDI0cHg7XG4gICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICBwYWRkaW5nLWJvdHRvbTogMTBweDtcbiAgICBib3JkZXItYm90dG9tOiAycHggc29saWQgI2U5ZWNlZjtcbn1cblxuLyogRXN0aWxvcyBwYXJhIGxhcyBldGlxdWV0YXMgKi9cbmxhYmVsIHtcbiAgICBkaXNwbGF5OiBibG9jaztcbiAgICBtYXJnaW4tYm90dG9tOiA4cHg7XG4gICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICBjb2xvcjogIzQ5NTA1NztcbiAgICBmb250LXNpemU6IDE0cHg7XG59XG5cbi8qIEVzdGlsb3MgcGFyYSBsb3MgaW5wdXRzIHkgc2VsZWN0cyAqL1xuaW5wdXQsIHNlbGVjdCB7XG4gICAgd2lkdGg6IDEwMCU7XG4gICAgcGFkZGluZzogMTJweCAxNXB4O1xuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NlZDRkYTtcbiAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIHRyYW5zaXRpb246IGFsbCAwLjNzIGVhc2U7XG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xufVxuXG5pbnB1dDpmb2N1cywgc2VsZWN0OmZvY3VzIHtcbiAgICBib3JkZXItY29sb3I6ICMwNTRmMzE7XG4gICAgYm94LXNoYWRvdzogMCAwIDAgM3B4IHJnYmEoNSwgNzksIDQ5LCAwLjEpO1xuICAgIG91dGxpbmU6IG5vbmU7XG59XG5cbmlucHV0W3R5cGU9XCJkYXRlXCJdIHtcbiAgICBhcHBlYXJhbmNlOiBub25lO1xuICAgIGJhY2tncm91bmQtcG9zaXRpb246IHJpZ2h0IDEwcHggY2VudGVyO1xuICAgIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG59XG5cbi8qIEVzdGlsb3MgcGFyYSBlbCBtZW5zYWplIGRlIGVycm9yICovXG4uZXJyb3ItbWVuc2FqZSB7XG4gICAgY29sb3I6ICNkYzM1NDU7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZDdkYTtcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjZjVjNmNiO1xuICAgIHBhZGRpbmc6IDEycHg7XG4gICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XG4gICAgZm9udC1zaXplOiAxNHB4O1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cblxuLyogRXN0aWxvcyBwYXJhIGVsIGJvdMODwrNuICovXG5idXR0b24ge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICMwNTRmMzE7XG4gICAgY29sb3I6IHdoaXRlO1xuICAgIHBhZGRpbmc6IDE0cHg7XG4gICAgYm9yZGVyOiBub25lO1xuICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICBmb250LXNpemU6IDE2cHg7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGZvbnQtd2VpZ2h0OiA2MDA7XG4gICAgdHJhbnNpdGlvbjogYWxsIDAuM3MgZWFzZTtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBtYXJnaW46IDIwcHggMCAxMHB4O1xuICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgIHRleHQtdHJhbnNmb3JtOiB1cHBlcmNhc2U7XG4gICAgbGV0dGVyLXNwYWNpbmc6IDAuNXB4O1xufVxuXG5idXR0b246aG92ZXIge1xuICAgIGJhY2tncm91bmQtY29sb3I6ICMwNDNhMjY7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC0ycHgpO1xuICAgIGJveC1zaGFkb3c6IDAgNHB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG59XG5cbmJ1dHRvbjphY3RpdmUge1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgwKTtcbn1cblxuLyogRXN0aWxvcyByZXNwb25zaXZvcyAqL1xuQG1lZGlhIChtYXgtd2lkdGg6IDc2OHB4KSB7XG4gICAgLmZvcm11bGFyaW8ge1xuICAgICAgICBwYWRkaW5nOiAyMHB4O1xuICAgICAgICBtYXJnaW46IDIwcHg7XG4gICAgfVxuICAgIFxuICAgIGgyIHtcbiAgICAgICAgZm9udC1zaXplOiAyMHB4O1xuICAgIH1cbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"names":["i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","m_r4","id","ɵɵadvance","ɵɵtextInterpolate","nombre","d_r5","v_r6","cedula","ɵɵtextInterpolate1","ctx_r3","errorMensaje","AsignarTratamientoComponent","constructor","tratamientoService","mascotaService","drogaService","location","tratamientoDTO","nombreTratamiento","fecha","drogaAsignadaID","mascotaID","veterinaroCedula","mascotas","drogas","veterinarios","ngOnInit","findAll","subscribe","onSubmit","Number","mascotaExiste","find","m","drogaExiste","d","veterinarioExiste","v","console","log","errores","push","join","unidadDisponible","unidadVendida","updateDroga","addTratamiento","response","back","error","ɵɵdirectiveInject","i1","TratamientoService","i2","MascotaService","i3","DrogaService","i4","Location","selectors","decls","vars","consts","template","AsignarTratamientoComponent_Template","rf","ctx","ɵɵlistener","AsignarTratamientoComponent_Template_input_ngModelChange_5_listener","$event","AsignarTratamientoComponent_Template_input_ngModelChange_8_listener","AsignarTratamientoComponent_Template_select_ngModelChange_11_listener","ɵɵtemplate","AsignarTratamientoComponent_option_14_Template","AsignarTratamientoComponent_Template_select_ngModelChange_17_listener","AsignarTratamientoComponent_option_20_Template","AsignarTratamientoComponent_Template_select_ngModelChange_23_listener","AsignarTratamientoComponent_option_26_Template","AsignarTratamientoComponent_div_27_Template","AsignarTratamientoComponent_Template_button_click_28_listener"],"sources":["/home/erick/Desarrollo-Web/veterinaria-angular/src/app/tratamiento/asignar-tratamiento/asignar-tratamiento.component.ts","/home/erick/Desarrollo-Web/veterinaria-angular/src/app/tratamiento/asignar-tratamiento/asignar-tratamiento.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { TratamientoService } from 'src/app/servicio/tratamiento.service';\nimport { MascotaService } from 'src/app/servicio/mascota.service';\nimport { DrogaService } from 'src/app/servicio/droga.service';\nimport { VeterinarioService } from 'src/app/servicio/veterinario.service';\nimport { Mascota } from 'src/app/modelo/mascota';\nimport { Droga } from 'src/app/modelo/droga';\nimport { Veterinario } from 'src/app/modelo/veterinario';\nimport { Tratamiento } from 'src/app/modelo/tratamiento';\nimport { TratamientoDTO } from 'src/app/modelo/tratamientoDTO';\nimport { Location } from '@angular/common';\n\n@Component({\n  selector: 'app-asignar-tratamiento',\n  templateUrl: './asignar-tratamiento.component.html',\n  styleUrls: ['./asignar-tratamiento.component.css']\n})\nexport class AsignarTratamientoComponent implements OnInit {\n\n  tratamientoDTO :TratamientoDTO= {  \n    id : -1,\n    nombreTratamiento: '',\n    fecha: '',\n    drogaAsignadaID: 0,\n    mascotaID: 0,\n    veterinaroCedula: ''\n  };\n\n  mascotas: Mascota[] = [];\n  drogas: Droga[] = [];\n  veterinarios: Veterinario[] = [];\n\n  errorMensaje: string = '';\n\n  constructor(\n    private tratamientoService: TratamientoService,\n    private mascotaService: MascotaService,\n    private drogaService: DrogaService,\n    private location:Location\n  ) {}\n\n  ngOnInit(): void {\n    this.mascotaService.findAll().subscribe((mascotas) => this.mascotas = mascotas);\n    this.drogaService.findAll().subscribe((drogas) => this.drogas = drogas);\n  }\n\n  onSubmit(): void {\n    this.errorMensaje = '';\n    this.tratamientoDTO.mascotaID = Number(this.tratamientoDTO.mascotaID)   \n    this.tratamientoDTO.drogaAsignadaID = Number(this.tratamientoDTO.drogaAsignadaID) \n    const mascotaExiste = this.mascotas.find(m => m.id === this.tratamientoDTO.mascotaID);\n    const drogaExiste = this.drogas.find(d => d.id === this.tratamientoDTO.drogaAsignadaID);\n    const veterinarioExiste = this.veterinarios.find(v => v.cedula === this.tratamientoDTO.veterinaroCedula);\n    console.log(this.tratamientoDTO)\n    if (!mascotaExiste || !drogaExiste || !veterinarioExiste) {\n      let errores = [];\n      if (!mascotaExiste) errores.push('la mascota');\n      if (!drogaExiste) errores.push('la droga');\n      if (!veterinarioExiste) errores.push('el veterinario');\n      this.errorMensaje = `Error: No se encontró ${errores.join(', ')} seleccionado(a).`;\n      return;\n    }\n\n    if(drogaExiste.unidadDisponible <= 0){\n      this.errorMensaje = `Error: No hay unidades disponibles de ${drogaExiste.nombre}`;\n      return;\n    }\n\n    drogaExiste.unidadDisponible--;\n    drogaExiste.unidadVendida++;\n\n    this.drogaService.updateDroga(drogaExiste).subscribe();\n\n    this.tratamientoService.addTratamiento(this.tratamientoDTO).subscribe(\n      (response) => {\n        console.log(response);\n        this.location.back();\n      },\n      (error) => {\n        this.errorMensaje = 'Ocurrió un error al asignar el tratamiento.';\n        console.error(error);\n      }\n    );\n  }\n}\n","<div class=\"formulario\">\n    <h2>Asignar Tratamiento</h2>\n  \n    <!-- Nombre del tratamiento -->\n    <label for=\"nombreTratamiento\">Nombre del Tratamiento:</label>\n    <input\n      type=\"text\"\n      id=\"nombreTratamiento\"\n      [(ngModel)]=\"tratamientoDTO.nombreTratamiento\"\n      name=\"nombreTratamiento\"\n      required\n    />\n  \n    <!-- Fecha -->\n    <label for=\"fecha\">Fecha:</label>\n    <input\n      type=\"date\"\n      id=\"fecha\"\n      [(ngModel)]=\"tratamientoDTO.fecha\"\n      name=\"fecha\"\n      required\n    />\n  \n    <!-- Mascota (ID) -->\n    <label for=\"mascota\">Mascota:</label>\n    <select\n      id=\"mascota\"\n      [(ngModel)]=\"tratamientoDTO.mascotaID\"\n      name=\"mascota\"\n      required\n    >\n      <option [value]=\"0\" disabled selected>Seleccione una mascota</option>\n      <option *ngFor=\"let m of mascotas\" [value]=\"m.id\">{{ m.nombre }}</option>\n    </select>\n  \n    <!-- Droga (ID) -->\n    <label for=\"droga\">Droga:</label>\n    <select\n      id=\"droga\"\n      [(ngModel)]=\"tratamientoDTO.drogaAsignadaID\"\n      name=\"droga\"\n      required\n    >\n      <option [value]=\"0\" disabled selected>Seleccione una droga</option>\n      <option *ngFor=\"let d of drogas\" [value]=\"d.id\">{{ d.nombre }}</option>\n    </select>\n  \n    <!-- Veterinario (Cédula) -->\n    <label for=\"veterinario\">Veterinario:</label>\n    <select\n      id=\"veterinario\"\n      [(ngModel)]=\"tratamientoDTO.veterinaroCedula\"\n      name=\"veterinario\"\n      required\n    >\n      <option value=\"\" disabled selected>Seleccione un veterinario</option>\n      <option *ngFor=\"let v of veterinarios\" [value]=\"v.cedula\">{{ v.nombre }}</option>\n    </select>\n  \n    <!-- Error en validación -->\n    <div *ngIf=\"errorMensaje\" class=\"error-mensaje\">\n      {{ errorMensaje }}\n    </div>\n  \n    <!-- Botón para enviar -->\n    <button (click)=\"onSubmit()\">Asignar Tratamiento</button>\n  </div>\n  \n  \n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}